(()=>{"use strict";var t={};function e(t,e,a){const n=document.createElement(t);return e&&n.classList.add(e),a&&(n.textContent=a),n}t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),(()=>{var e;t.g.importScripts&&(e=t.g.location+"");var a=t.g.document;if(!e&&a&&(a.currentScript&&(e=a.currentScript.src),!e)){var n=a.getElementsByTagName("script");if(n.length)for(var r=n.length-1;r>-1&&!e;)e=n[r--].src}if(!e)throw new i("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),t.p=e})();const a=t.p+"assets/7cf13055e656b8653925.svg";const n=["Имя пользователя","E-mail","Дата регистрации","Рейтинг"],r=t.p+"assets/46a295f9e65c591ad74b.svg",c=t.p+"assets/d259ece76fb759cd5e4f.svg";function i(){const t=e("div","error"),a=e("div","error__header","Упс... что-то пошло не так"),n=e("div","error__text","Приносим свои извенеия, уже работаем над ошибкой."),r=e("div","error__text","Попробуйте зайти через некоторое время!");return t.append(a,n,r),t}const s=document.querySelector(".main"),o={data:null,currentData:null,sort:null,search:null,page:1,activeSearch:!1};function d(){if(s.innerHTML="",s.append(function(t,a,n,i){const s=e("div","search"),o=e("div","search-input__wrapper"),d=e("img","search-input__img");d.src=r,d.alt="Search";const l=e("input","search__input");if(l.placeholder="Поиск по имени или e-mail",t&&(l.value=t),l.addEventListener("input",(t=>{i(l.value,t.target.selectionStart)})),o.append(d,l),s.append(o),t||a){const t=e("button","clean__btn");t.addEventListener("click",n);const a=e("img","clean-btn__img");a.src=c,a.alt="Clean";const r=e("span","clean-btn__text","Очистить фильтр");t.append(a,r),s.append(t)}return s}(o.search,o.sort,u,g),function(t,a){const n=e("div","sort"),r=e("div","sort__text","Сортировка:"),c=e("div","sort__item","Дата регистрации");"ascDate"!==t&&"descDate"!==t||c.classList.add("sort__item--active"),c.addEventListener("click",(()=>{a("ascDate"===t?"descDate":"ascDate")}));const i=e("div","sort__item","Рейтинг");return"ascRating"!==t&&"descRating"!==t||i.classList.add("sort__item--active"),i.addEventListener("click",(()=>{a("ascRating"===t?"descRating":"ascRating")})),n.append(r,c,i),n}(o.sort,v),function(t,r,c){const i=5*(r-1),s=i+5,o=t.slice(i,s),d=e("div","list"),l=e("div","list__header");if(n.forEach((t=>{const a=e("div");a.textContent=t,l.append(a)})),d.append(l),t.length)o.forEach((t=>{d.append(function(t,n){if(t){const r=e("div","item"),c=e("div","item__name",t.username),i=e("div","item__field",t.email),s=e("div","item__field",function(t){const e=new Date(t),a=e.getMonth()+1,n=e.getDate(),r=e.getFullYear();return`${String(n).padStart(2,"0")}.${String(a).padStart(2,"0")}.${String(r).substring(2)}`}(t.registration_date)),o=e("div","item__rating",t.rating),d=e("button","item-delete__btn"),l=e("img","item-delete__img");return l.src=a,l.alt="Delete",d.addEventListener("click",(()=>function(t,a){const n=e("div","overlay");n.addEventListener("click",(t=>{t.target.classList.contains("overlay")&&(n.remove(),document.body.style.overflow="")}));const r=e("div","modal"),c=e("div","modal__text","Вы уверены, что хотите удалить пользователя?"),i=e("div","modal-btn__wrapper"),s=e("button","modal-btn__delete","Да");s.addEventListener("click",(()=>{a(t),n.remove(),document.body.style.overflow=""}));const o=e("button","modal-btn__close","Нет");o.addEventListener("click",(()=>{n.remove(),document.body.style.overflow=""})),i.append(s,o),r.append(c,i),n.append(r),document.body.append(n),document.body.style.overflow="hidden"}(t.id,n))),d.append(l),o.append(d),r.append(c,i,s,o),r}}(t,c))}));else{const t=e("div","empty__list","Список пустой");d.append(t)}return d}(o.currentData,o.page,p),function(t,a,n){const r=e("div","pagination");let c=1;for(;c<=Math.ceil(a/5);){const a=e("div","pagination__number",c);c===t?a.classList.add("pagination__nubmer--active"):a.addEventListener("click",(()=>{n(+a.textContent)})),r.append(a),c+=1}return r}(o.page,o.currentData.length,l)),!1!==o.activeSearch){const t=document.querySelector(".search__input");t.focus(),t.setSelectionRange(+o.activeSearch,+o.activeSearch)}}function l(t){o.page=t,o.activeSearch=!1,d()}function u(){o.currentData=o.data.slice(0),o.sort=null,o.search=null,o.page=1,o.activeSearch=!1,d()}function p(t){o.activeSearch=!1,o.data=o.data.filter((e=>e.id!==t)),o.currentData=o.currentData.filter((e=>e.id!==t)),o.page-1==o.currentData.length/5&&(o.page-=1),d()}function v(t){switch(t&&(o.sort=t,o.activeSearch=!1),o.page=1,o.sort){case"ascDate":o.currentData=o.currentData.sort(((t,e)=>new Date(e.registration_date)-new Date(t.registration_date)));break;case"descDate":o.currentData=o.currentData.sort(((t,e)=>new Date(t.registration_date)-new Date(e.registration_date)));break;case"ascRating":o.currentData=o.currentData.sort(((t,e)=>e.rating-t.rating));break;case"descRating":o.currentData=o.currentData.sort(((t,e)=>t.rating-e.rating));break;default:o.currentData=o.data}d()}function g(t,e){o.search=t,o.activeSearch=e,o.currentData=o.data.filter((t=>{const e=new RegExp(o.search.trimStart().replace(/(?=\W)/g,"\\"),"gi");return t.username.match(e)||t.email.match(e)})),o.sort&&v(),d()}fetch("https://5ebbb8e5f2cfeb001697d05c.mockapi.io/users").then((t=>t.json())).then((t=>t)).catch((t=>t)).then((t=>{Array.isArray(t)?(o.data=t.slice(),o.currentData=t.slice(),d()):(document.body.innerHTML="",document.body.append(i()))}))})();